# 功能规划

## 已实现功能

1. **命令行参数支持** (已实现)
   - 允许用户通过命令行指定目标URL、深度、文件数量等参数
   - 支持帮助信息和参数验证

2. **配置文件支持** (已实现)
   - 使用YAML配置文件管理参数
   - 支持默认配置和用户自定义配置
   - 配置文件自动加载和合并
   - 取消硬编码配置，完全使用配置文件管理

3. **多线程/多进程支持** (已实现)
   - 实现并行抓取，提高抓取速度
   - 支持线程数配置

4. **断点续传功能** (已实现)
   - 在抓取中断后可以继续之前的抓取
   - 记录已下载的文件，避免重复下载
   - 保存抓取状态，包括已访问的URL和已下载的文件
   - 可通过配置文件或命令行参数启用/禁用
   - 可配置状态文件路径

5. **爬虫延迟设置** (已实现)
   - 支持设置请求间隔，避免对目标服务器造成过大压力
   - 支持随机延迟，模拟真实用户行为

6. **自定义用户代理** (已实现)
   - 支持通过配置文件或命令行参数设置自定义用户代理
   - 默认使用现代浏览器的用户代理字符串
   - 确保所有HTTP请求和JavaScript渲染都使用配置的用户代理

7. **JavaScript渲染支持** (已实现)
   - 使用Pyppeteer支持动态加载的内容
   - 可配置是否启用JavaScript渲染
   - 可配置渲染超时时间
   - 自动降级机制，当渲染失败时回退到常规HTTP请求
   - 支持通过配置文件或命令行参数启用/禁用

8. **高级排除列表** (已实现)
   - 支持正则表达式匹配
   - 支持包含列表和排除列表

9. **代理支持** (已实现)
   - 支持HTTP和HTTPS代理
   - 支持代理认证

10. **站点地图生成** (已实现)
    - 生成抓取内容的站点地图
    - 支持XML和HTML格式
    - 使用页面标题作为链接文本
    - 使用本地文件路径作为URL
    - 可通过配置文件或命令行参数启用/禁用

11. **压缩功能**
    - 支持压缩下载的内容，节省空间
    - 支持ZIP、TAR等格式

12. **增量抓取** (已实现)
    - 只抓取更新的内容
    - 基于时间戳的判断，不使用状态文件
    - 比较本地文件修改时间与远程服务器的 Last-Modified 头部

13. **高级错误处理** (已实现)
    - 更完善的错误处理和重试机制
    - 支持自定义重试策略
    - HTTP 请求失败时的自动重试
    - 网络超时的智能处理
    - 服务器错误（5xx）的重试策略
    - 支持自定义重试次数和间隔
    - 支持指数退避算法
    - 可配置的失败处理策略（仅记录、跳过、抛出异常）

14. **自定义文件命名规则**
    - 支持根据用户需求命名文件
    - 支持模板化命名

15. **多格式输出**
    - 支持MHTML、WARC等格式
    - 支持导出为静态网站生成器格式

16. **GUI界面** (已实现)
    - 使用tkinter开发的图形界面
    - 支持基本配置、高级配置、插件配置和日志查看
    - 支持通过GUI启动和停止抓取任务
    - 支持实时日志显示
    - 支持国际化（英文和中文）

17. **插件系统** (已实现)
    - 支持自定义插件扩展功能
    - 提供插件开发API
    - 支持插件的发现、加载、注册和管理
    - 提供丰富的钩子方法
    - 保存功能已重构为插件形式 (Save Plugin)
    - 支持通过插件系统处理保存功能

18. **国际化支持** (已实现)
    - 支持英文和中文语言
    - 使用Python标准库gettext实现翻译功能
    - 可通过配置文件或命令行参数设置语言
    - 集成到主脚本和日志系统
    - 实现自动降级机制，当翻译文件不存在时使用默认语言

## 未来计划

### 高优先级

1. **单元测试**
   - 使用 pytest 添加单元测试
   - 覆盖核心功能：URL解析、链接处理、错误处理

2. **类型检查**
   - 使用 mypy 进行静态类型检查
   - 提高代码可靠性

3. **代码格式化**
   - 使用 black 或 yapf 统一代码格式

4. **持续集成**
   - 配置 GitHub Actions
   - 自动运行测试和代码检查

### 中优先级

1. **高级排除列表**
   - 支持正则表达式匹配
   - 支持包含列表和排除列表

2. **代理支持增强**
   - 支持HTTP和HTTPS代理
   - 支持代理认证

3. **压缩功能**
   - 支持压缩下载的内容
   - 支持ZIP、TAR等格式

4. **自定义文件命名规则**
   - 支持根据用户需求命名文件
   - 支持模板化命名

5. **多格式输出**
   - 支持MHTML、WARC等格式
   - 支持导出为静态网站生成器格式

### 低优先级

1. **Web界面**
   - 基于Web的配置界面
   - 实时抓取进度监控

2. **API接口**
   - RESTful API
   - 支持远程调用

3. **分布式抓取**
   - 支持多台机器协同抓取
   - 任务分发和结果合并
